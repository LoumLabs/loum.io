(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{381:function(e,r,t){Promise.resolve().then(t.bind(t,8836))},8836:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return f}});var a=t(3827),s=t(4090),i=t(8745),n=t(8371),l=t(3835),c=t(3371),o=t(8096),d=t(4710),u=t(7474),m=t(954),x=t(9146),g=t(8621),h=t(6431);let p=["mp3","wav","m4a","mp4","aac","ogg","wma","flac"];function f(){let[e,r]=(0,s.useState)(!1),[t,f]=(0,s.useState)(!1),[y,b]=(0,s.useState)([]),[w,v]=(0,s.useState)(0),[j,N]=(0,s.useState)([]),[k,C]=(0,s.useState)(!1),[R,S]=(0,s.useState)(null),[T,E]=(0,s.useState)(!1),F=(0,s.useRef)(null),B=(0,s.useRef)([]),z=(0,s.useRef)(null),A=(0,s.useRef)(null),D=(0,s.useRef)(null),M=(0,s.useRef)(null),P=(0,s.useRef)(null),U=(0,s.useRef)(null),Z=(0,s.useRef)(null),I=async e=>{try{let r;console.log("Sending file for transcription:",{name:e.name,type:e.type,size:Math.round(e.size/1024/1024*100)/100+"MB"});let t=new FormData;t.append("file",e);let a=await fetch("/api/transcribe",{method:"POST",body:t,headers:{}});a.headers.get("content-type");try{r=await a.json()}catch(e){throw console.error("Failed to parse response as JSON:",e),Error("Invalid response from server")}if(!a.ok)throw console.error("Server error:",r),Error(r.details||r.error||"Transcription failed");if(!r.text)throw console.error("Invalid response data:",r),Error("No transcription text received");return r}catch(e){throw console.error("Transcription error:",e),Error(e.message||"Failed to transcribe audio")}},L=async e=>{var r,t;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];if(!a)return;if(a.size/1048576>500){W("File size exceeds ".concat(500,"MB limit. Please choose a smaller file."),"error");return}let s=null===(t=a.name.split(".").pop())||void 0===t?void 0:t.toLowerCase();if(!s||!p.includes(s)){W("Unsupported file format. Please upload one of: ".concat(p.join(", ")),"error");return}f(!0),v(0);let i={id:Date.now().toString(),fileName:a.name,text:"Processing...",timestamp:new Date,processing:!0};b(e=>[i,...e]);try{let e=setInterval(()=>{v(r=>r>=90?(clearInterval(e),90):r+10)},1e3),{text:r,confidence:t}=await I(a);b(e=>e.map(e=>e.id===i.id?{...e,text:r,processing:!1,confidence:t}:e)),clearInterval(e),v(100),f(!1),W("Transcription completed successfully")}catch(e){b(r=>r.map(r=>r.id===i.id?{...r,text:"Transcription failed: ".concat(e.message),processing:!1}:r)),W(e.message||"Transcription failed","error"),f(!1)}},O=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});M.current=e;let r=new MediaRecorder(e);if(F.current=r,B.current=[],D.current&&P.current){D.current.createMediaStreamSource(e).connect(P.current);let r=()=>{if(!k)return;let e=document.getElementById("liveWaveform");if(!e)return;let t=e.getContext("2d");if(!t||!P.current||!U.current)return;let a=P.current.frequencyBinCount;P.current.getByteTimeDomainData(U.current),t.fillStyle="rgb(255, 255, 255)",t.fillRect(0,0,e.width,e.height),t.lineWidth=2,t.strokeStyle="rgb(79, 70, 229)",t.beginPath();let s=e.width/a,i=0;for(let r=0;r<a;r++){let a=U.current[r]/128*e.height/2;0===r?t.moveTo(i,a):t.lineTo(i,a),i+=s}t.lineTo(e.width,e.height/2),t.stroke(),Z.current=requestAnimationFrame(r)};r()}r.ondataavailable=e=>{e.data.size>0&&B.current.push(e.data)},r.onstop=()=>{let r=new Blob(B.current,{type:"audio/wav"});S(r),e.getTracks().forEach(e=>e.stop()),Z.current&&cancelAnimationFrame(Z.current)},r.start(),C(!0),W("Recording started")}catch(e){console.error("Error starting recording:",e),W(e.message||"Failed to start recording","error")}},_=async()=>{if(!R){W("No recording available","error");return}let e=new File([R],"recording.wav",{type:"audio/wav"});f(!0),v(0);let r={id:Date.now().toString(),fileName:"Voice Recording",text:"Processing...",timestamp:new Date,processing:!0};b(e=>[r,...e]);try{let t=setInterval(()=>{v(e=>e>=90?(clearInterval(t),90):e+10)},1e3),{text:a,confidence:s}=await I(e);b(e=>e.map(e=>e.id===r.id?{...e,text:a,processing:!1,confidence:s}:e)),clearInterval(t),v(100),f(!1),S(null),W("Transcription completed successfully")}catch(e){b(t=>t.map(t=>t.id===r.id?{...t,text:"Transcription failed: ".concat(e.message),processing:!1}:t)),W(e.message||"Transcription failed","error"),f(!1)}},W=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",t=Date.now().toString();N(a=>[...a,{id:t,message:e,type:r}]),setTimeout(()=>{N(e=>e.filter(e=>e.id!==t))},3e3)},q=e=>{N(r=>r.filter(r=>r.id!==e))},G=(e,r)=>{let t=document.createElement("a"),a=new Blob([e],{type:"text/plain"});t.href=URL.createObjectURL(a),t.download="".concat(r.split(".")[0],"_transcription.txt"),document.body.appendChild(t),t.click(),document.body.removeChild(t)},J=e=>{b(r=>r.filter(r=>r.id!==e))};return(0,s.useEffect)(()=>{if(R&&z.current){A.current&&A.current.destroy();let e=h.Z.create({container:z.current,waveColor:"#4F46E5",progressColor:"#818CF8",cursorColor:"#C7D2FE",barWidth:2,barGap:1,height:100,normalize:!0,backend:"WebAudio"});e.on("play",()=>E(!0)),e.on("pause",()=>E(!1)),e.on("finish",()=>E(!1));let r=URL.createObjectURL(R);return e.load(r),A.current=e,()=>{URL.revokeObjectURL(r),e.destroy()}}},[R]),(0,s.useEffect)(()=>{if(k&&!D.current){D.current=new AudioContext;let e=D.current.createAnalyser();e.fftSize=256,P.current=e,U.current=new Uint8Array(e.frequencyBinCount)}return()=>{D.current&&(D.current.close(),D.current=null),Z.current&&cancelAnimationFrame(Z.current)}},[k]),(0,a.jsxs)("main",{className:"min-h-screen p-8 pt-16",children:[(0,a.jsx)("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-50 flex flex-col items-center",children:(0,a.jsx)(i.M,{children:j.map(e=>(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-2 bg-green-50 dark:bg-green-900/20 rounded-lg shadow-lg p-3 flex items-center text-sm border border-green-100 dark:border-green-800 min-w-[200px] justify-center cursor-pointer hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors",onClick:()=>q(e.id),children:[(0,a.jsx)(l.Z,{className:"w-5 h-5 text-green-600 dark:text-green-400 mr-2"}),(0,a.jsx)("span",{className:"text-green-800 dark:text-green-200",children:e.message})]},e.id))})}),(0,a.jsxs)("div",{className:"flex flex-col items-center w-full max-w-3xl mx-auto p-4",children:[(0,a.jsxs)("div",{className:"text-center mb-12",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center mb-4",children:[(0,a.jsx)(c.Z,{className:"w-12 h-12 text-primary mr-2"}),(0,a.jsx)("h1",{className:"text-4xl font-bold",children:"Audio to Text"})]}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"Secure, Fast, and Accurate Audio Transcription"})]}),(0,a.jsx)(n.E.div,{className:"fixed top-4 right-4",initial:{opacity:0},animate:{opacity:1},children:(0,a.jsxs)("label",{className:"swap swap-rotate",children:[(0,a.jsx)("input",{type:"checkbox",checked:e,onChange:()=>{r(!e),document.documentElement.classList.toggle("dark")},className:"hidden"}),e?(0,a.jsx)(o.Z,{className:"w-6 h-6 text-yellow-400"}):(0,a.jsx)(d.Z,{className:"w-6 h-6 text-gray-600"})]})}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg p-8 text-center relative bg-white dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsxs)("div",{className:"group relative",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 text-gray-400 hover:text-primary cursor-help"}),(0,a.jsxs)("div",{className:"hidden group-hover:block absolute right-0 w-64 p-2 bg-white dark:bg-gray-800 rounded-lg shadow-lg text-sm text-left mt-1 z-10",children:[(0,a.jsxs)("p",{className:"mb-2",children:["Supported formats: ",p.join(", ")]}),(0,a.jsxs)("p",{children:["Maximum file size: ",500,"MB"]})]})]})}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Upload Audio File"}),(0,a.jsx)("input",{type:"file",accept:"audio/*",onChange:L,className:"hidden",id:"audio-upload",disabled:t||k}),(0,a.jsxs)("label",{htmlFor:"audio-upload",className:"flex flex-col items-center cursor-pointer group ".concat(t||k?"opacity-50 cursor-not-allowed":""),children:[(0,a.jsx)(m.Z,{className:"w-12 h-12 text-gray-400 group-hover:text-primary mb-4"}),(0,a.jsx)("span",{className:"text-lg mb-2",children:"Drop your audio file here"}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"or click to browse"})]})]}),(0,a.jsxs)("div",{className:"flex items-center my-8",children:[(0,a.jsx)("div",{className:"flex-grow border-t border-gray-300 dark:border-gray-700"}),(0,a.jsx)("span",{className:"mx-4 text-gray-500",children:"or"}),(0,a.jsx)("div",{className:"flex-grow border-t border-gray-300 dark:border-gray-700"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Record Audio"}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[k&&(0,a.jsx)("div",{className:"w-full h-[100px] bg-white dark:bg-gray-900 rounded-lg overflow-hidden",children:(0,a.jsx)("canvas",{id:"liveWaveform",className:"w-full h-full",width:800,height:100})}),R&&!k&&(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("div",{ref:z,className:"mb-4 bg-gray-50 dark:bg-gray-900 rounded-lg p-4"}),(0,a.jsx)("button",{onClick:()=>{A.current&&(T?A.current.pause():A.current.play())},className:"bg-primary hover:bg-primary/90 text-white font-semibold py-2 px-4 rounded-lg flex items-center gap-2",children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,a.jsx)("rect",{x:"6",y:"4",width:"3",height:"12"}),(0,a.jsx)("rect",{x:"11",y:"4",width:"3",height:"12"})]}),"Pause"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M8 5v10l8-5-8-5z"})}),"Play"]})})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[k?(0,a.jsxs)("button",{onClick:()=>{F.current&&k&&(F.current.stop(),C(!1),W("Recording stopped"))},className:"bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg flex items-center gap-2",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("rect",{x:"6",y:"6",width:"8",height:"8"})}),"Stop Recording"]}):(0,a.jsxs)("button",{onClick:O,disabled:t,className:"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("circle",{cx:"10",cy:"10",r:"6"})}),"Start Recording"]}),R&&(0,a.jsx)("button",{onClick:_,disabled:t,className:"bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Transcribe Recording"})]})]})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-center text-sm text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 mr-2"}),(0,a.jsx)("p",{children:"Your files are processed securely and automatically deleted after 24 hours"})]}),t&&(0,a.jsxs)(n.E.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-8",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:(0,a.jsx)("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-500",style:{width:"".concat(w,"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsx)("span",{children:"Processing your audio..."}),(0,a.jsxs)("span",{children:[w,"%"]})]})]}),(0,a.jsx)(i.M,{children:y.map((e,r)=>(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.1*r},className:"mt-8 mb-12",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg ring-1 ring-gray-100 dark:ring-gray-700 relative",children:[(0,a.jsx)("button",{onClick:()=>J(e.id),className:"absolute top-4 right-4 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Remove transcription",children:(0,a.jsx)(g.Z,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(c.Z,{className:"w-6 h-6 text-primary mr-3 flex-shrink-0"}),(0,a.jsx)("h2",{className:"text-lg font-semibold truncate",children:e.fileName})]}),void 0!==e.confidence&&(0,a.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Confidence: ",Math.round(100*e.confidence),"%"]})]}),(0,a.jsx)("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:(0,a.jsxs)("span",{className:"inline-block",children:["Transcribed ",e.timestamp.toLocaleString()]})})]}),(0,a.jsx)("textarea",{value:e.text,onChange:r=>{b(y.map(t=>t.id===e.id?{...t,text:r.target.value}:t))},className:"w-full h-48 p-4 bg-transparent border border-gray-300 dark:border-gray-700 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary mt-4",placeholder:e.processing?"Transcribing...":"Transcribed text will appear here...",disabled:e.processing}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)("button",{onClick:async()=>{await navigator.clipboard.writeText(e.text),W("Copied to clipboard")},className:"px-4 py-2 bg-secondary text-white rounded-lg hover:bg-green-600 transition-colors",children:"Copy"}),(0,a.jsx)("button",{onClick:()=>{G(e.text,e.fileName),W("Transcription downloaded successfully")},className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Download"})]})})]})},e.id))})]})]})]})}}},function(e){e.O(0,[391,971,69,744],function(){return e(e.s=381)}),_N_E=e.O()}]);